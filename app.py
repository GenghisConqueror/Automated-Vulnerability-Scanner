from flask import Flask, request, render_template
from scan_modules import scan_network, check_xss, get_cve_details

app = Flask(__name__)

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/scan_network', methods=['POST'])
def scan_network_route():
    network = request.form['network']
    hosts = scan_network(network)
    return render_template('network_results.html', hosts=hosts)

@app.route('/scan_url', methods=['POST'])
def scan_url_route():
    url = request.form['url']
    vulnerable = check_xss(url)
    return render_template('url.html', url=url, vulnerable=vulnerable)

@app.route('/cve_lookup', methods=['POST'])
def cve_lookup_route():
    cve_id = request.form['cve_id']
    details = get_cve_details(cve_id)
    return render_template('cve_results.html', cve_id=cve_id, details=details)

if __name__ == '__main__':
    app.run(debug=True)
